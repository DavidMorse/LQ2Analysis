#include "TCanvas.h"
#include "TMath.h"
#include "TGraph.h"
#include "TLegend.h"

using namespace std;
void setTDRStyle();
void dontrun();

void PlotLimitRatio(){

  TCanvas *c2 = new TCanvas("c2","A Simple Graph Example",850,800);
  c2->cd();
 
  Double_t plotLow=0.1, plotHigh=100.;
  string title = ";M_{ LQ} [GeV];Mean Expected Limit Ratio";

  TH2F *bg = new TH2F("bg",title.c_str(), 500, 400., 3500., 500., plotLow, plotHigh);

  bg->SetStats(kFALSE);
  bg->SetTitleOffset(1.,"X");
  bg->SetTitleOffset(1.15,"Y");
 
  bg->Draw();
  c2->SetGrid();


  //  const int nm2016 = 28;
  //  const int nm2017 = 28;
  //  const int nm2018 = 26;
  //
  //  const int nm2016_2 = nm2016*2;
  //  const int nm2017_2 = nm2017*2;
  //  const int nm2018_2 = nm2018*2;
  //
  //
  //  // 2016 Nominal values
  //  
  //  // Masses
  //  Double_t lqmass2016[nm2016] = {400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0,1600.0,1700.0,1800.0,1900.0,2000.0,2100.0,2200.0,2300.0,2400.0,2500.0,2600.0,2700.0,2800.0,2900.0,3000.0,3500.0};
  //
  //  // Nominal central
  //  Double_t xs2016[nm2016] = { 0.0010878 , 0.0005511 , 0.00046062 , 0.000270858 , 0.00020904 , 0.0001785 , 0.000211776 , 0.000172544 , 0.0001512904 , 0.00013038215 , 0.000115248 , 0.00011186944 , 0.0001132308 , 0.000132705343 , 0.000138717432 , 0.000119443348 , 0.000118198228 , 0.0001261848885 , 0.0001322743154 , 0.0001347118348 , 0.000140903044 , 0.0001455690855 , 0.0003441773285 , 0.0001426868407 , 0.0001594969563 , 0.000155921802901 , 0.000163771417832 , 0.00018511751282 };
  //  
  //  // Nominal error (low to high)
  //  Double_t xs2016_1sigma[nm2016_2]={0.0009065 , 0.0004008 , 0.00030708 , 0.000180572 , 0.000134 , 0.00011305 , 0.000138978 , 0.000110536 , 9.422e-05 , 7.732046e-05 , 6.65175e-05 , 6.31426e-05 , 6.39e-05 , 7.8999849e-05 , 8.2223016e-05 , 6.7093084e-05 , 6.4535228e-05 , 6.99008295e-05 , 7.25716386e-05 , 7.39090567e-05 , 7.73058e-05 , 7.90927515e-05 , 0.0002144805959 , 7.25408929e-05 , 8.410973142e-05 , 7.9692941764e-05 , 8.370495111e-05 , 8.95307137605e-05 , 0.00481185984375 , 0.00537097577689 , 0.000570664500053 , 0.0005498476005 , 0.0005692968319 , 0.000500710243 , 0.00105252576 , 0.000492922896 , 0.0004800879391 , 0.0004578298364 , 0.0004525334295 , 0.000424353458 , 0.00039415336 , 0.00040153056 , 0.000437660226 , 0.0004207389 , 0.00038360848 , 0.0003812445 , 0.00039583042 , 0.0004391998 , 0.0005036128 , 0.0005730085 , 0.00071876 , 0.0006566 , 0.000812574 , 0.00112596 , 0.002004 , 0.0029008};
  //  
  //  //2016 Study values
  //
  //  //Down central
  //  Double_t xsDown2016[nm2016] = { 0.0032634 , 0.0011523 , 0.00058004 , 0.000438532 , 0.00027872 , 0.00020587 , 0.0001748255 , 0.0002070528 , 0.0001730956 , 0.00015142506 , 0.0001300215 , 0.00011493328 , 0.0001127196 , 0.000115627964 , 0.000135758232 , 0.000145640416 , 0.000122902858 , 0.0001221157515 , 0.0001318313626 , 0.0001363465372 , 0.000140908874 , 0.0001470667335 , 0.0001523616622 , 0.0003642233718 , 0.00014722464372 , 0.000166789038531 , 0.000162904917264 , 0.000196893287514 }; 
  //  // Down error (low to high)
  //  Double_t xsDown2016_1sigma[nm2016_2]={0.0023569 , 0.0008016 , 0.00039238 , 0.000303103 , 0.00018492 , 0.00013328 , 0.0001108515 , 0.0001364176 , 0.000110372 , 9.465814e-05 , 7.706475e-05 , 6.575472e-05 , 6.361245e-05 , 6.5251762e-05 , 8.0470512e-05 , 8.63273e-05 , 6.8082196e-05 , 6.6349572e-05 , 7.26787622e-05 , 7.48058726e-05 , 7.730898e-05 , 7.95295245e-05 , 8.19836774e-05 , 0.0002243939721 , 7.44480099e-05 , 8.7059311532e-05 , 8.2819609232e-05 , 9.79298965485e-05 , 0.000396238875597 , 0.000327838786604 , 0.000335655421561 , 0.0002962829496 , 0.0006342600237 , 0.0003017624081 , 0.0002877581925 , 0.00027458611 , 0.0002635215081 , 0.0002516422086 , 0.000234069804 , 0.000230680044 , 0.000259422448 , 0.000240737496 , 0.000212419455 , 0.00020706795 , 0.00020745732 , 0.0002285115 , 0.00025286447 , 0.000280641 , 0.0003270248 , 0.000284574 , 0.00033201 , 0.00043684 , 0.000657798 , 0.00087006 , 0.0016533 , 0.0048951 }; 
  //  // Down error (high)
  //  Double_t xsDown2016_1sigma_high[nm2016]={0.0048951 , 0.0016533 , 0.00087006 , 0.000657798 , 0.00043684 , 0.00033201 , 0.000284574 , 0.0003270248 , 0.000280641 , 0.00025286447 , 0.0002285115 , 0.00020745732 , 0.00020706795 , 0.000212419455 , 0.000240737496 , 0.000259422448 , 0.000230680044 , 0.000234069804 , 0.0002516422086 , 0.0002635215081 , 0.00027458611 , 0.0002877581925 , 0.0003017624081 , 0.0006342600237 , 0.0002962829496 , 0.000335655421561 , 0.000327838786604 , 0.000396238875597}; 
  //
  //  // Up central
  //  Double_t xsUp2016[nm2016] = { 0.0012691 , 0.0006513 , 0.00037532 , 0.000264409 , 0.00020368 , 0.00022372 , 0.0001825465 , 0.0001552896 , 0.0001336578 , 0.00011737889 , 0.0001137045 , 0.00011359776 , 0.0001301217 , 0.000136028732 , 0.0001147512 , 0.000116070688 , 0.00012297163 , 0.0001276804635 , 0.0001309283698 , 0.0001352716236 , 0.000141523886 , 0.0003292153425 , 0.0001378527247 , 0.0001558014382 , 0.0001502952099 , 0.000158086977351 , 0.000155972775894 , 0.000187361346861 };
  //  // Up error (low to high)
  //  Double_t xsUp2016_1sigma[nm2016_2]={0.0009065 , 0.0004509 , 0.0002559 , 0.000167674 , 0.00012864 , 0.00014637 , 0.0001163665 , 9.7056e-05 , 7.92794e-05 , 6.746315e-05 , 6.44595e-05 , 6.410496e-05 , 7.74681e-05 , 8.0983257e-05 , 6.4454664e-05 , 6.3682036e-05 , 6.875116e-05 , 7.03899705e-05 , 7.18332744e-05 , 7.42161217e-05 , 7.7270608e-05 , 0.0002060007075 , 7.08446998e-05 , 8.25793285e-05 , 7.764274782e-05 , 8.1667972726e-05 , 7.7160541342e-05 , 9.11305324755e-05 , 0.000377056242486 , 0.000313888155564 , 0.000318142902814 , 0.00030246233094 , 0.0003135433453 , 0.000277422336 , 0.0005627988 , 0.000274656176 , 0.0002603656243 , 0.0002499187016 , 0.000242700738 , 0.000230809252 , 0.00021970732 , 0.00021263496 , 0.000239047888 , 0.00022866615 , 0.00020869464 , 0.0002070495 , 0.00021189721 , 0.000232858 , 0.0002580072 , 0.000294501 , 0.00035105 , 0.00033232 , 0.000419185 , 0.0005971 , 0.001002 , 0.0019943};
  //
  //
  //  //2017 Nominal values
  //
  //  // Masses
  //  Double_t lqmass2017[nm2017] = {400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0,1600.0,1700.0,1800.0,1900.0,2000.0,2100.0,2200.0,2300.0,2400.0,2500.0,2600.0,2700.0,2800.0,2900.0,3000.0,3500.0};
  //
  //  // Nominal central
  //  Double_t xs2017[nm2017] = { 0.0010878 , 0.000501 , 0.00044356 , 0.000561063 , 0.0002278 , 0.00019278 , 0.000401492 , 0.0001668824 , 0.0001483292 , 0.00011975583 , 0.00025368525 , 0.00012396768 , 0.00010804425 , 0.000127451673 , 0.000127814424 , 0.000114520544 , 0.000118342024 , 0.0001275854505 , 0.0002238741942 , 0.0001289833046 , 0.000264169172 , 0.0002391718395 , 0.0002602081518 , 0.0001163619864 , 0.00011830100964 , 0.000268026327276 , 0.00013244621823 , 0.000142927861865 };
  //
  //  // Nominal error (low to high)
  //  Double_t xs2017_1sigma[nm2017_2]={0.0007252 , 0.0003507 , 0.00030708 , 0.000380491 , 0.00015008 , 0.00012614 , 0.0002663745 , 0.00010784 , 9.422e-05 , 7.249667e-05 , 0.00015615075 , 7.565328e-05 , 6.320775e-05 , 7.8444967e-05 , 7.86654e-05 , 6.7880952e-05 , 7.0453788e-05 , 7.72180035e-05 , 0.0001275142158 , 7.7402712e-05 , 0.000157954946 , 0.0001386653415 , 0.0001716509758 , 6.5055886e-05 , 6.553345062e-05 , 0.000155394413403 , 7.578633126e-05 , 7.9908401745e-05 , 0.000265837641903 , 0.00381834303033 , 0.000417634016623 , 0.0008478274629 , 0.0003904735414 , 0.000375981093 , 0.0007240479255 , 0.000744151694 , 0.0008076483182 , 0.0003966014698 , 0.000727685799 , 0.000391115742 , 0.00036318704 , 0.000360345072 , 0.000388618102 , 0.0003894279 , 0.0003517524 , 0.000394695 , 0.00081731781 , 0.0003978776 , 0.0004842016 , 0.000545985 , 0.00134232 , 0.00068608 , 0.000857717 , 0.00226898 , 0.0018537 , 0.0029008}; 
  //
  //  //2017 Study values
  //
  //  // Down central
  //  Double_t xsDown2017[nm2017] = {0.0038073 , 0.0011523 , 0.00056298 , 0.000831921 , 0.00028408 , 0.00022372 , 0.0003722625 , 0.0002003128 , 0.0001638082 , 0.00014855875 , 0.00023663325 , 0.00012681548 , 0.0001255635 , 0.000109004798 , 0.000128777808 , 0.00013091222 , 0.000116561246 , 0.000121548606 , 0.000268204963 , 0.0001123230743 , 0.000263305272 , 0.0002712565125 , 0.0001237708748 , 0.000268652189 , 0.00011916160608 , 0.000243460929641 , 0.000136417045576 , 0.000150202041552 };   
  //
  //  // Down error (low to high)
  //  Double_t xsDown2017_1sigma[nm2017_2]={0.0027195 , 0.0008016 , 0.00039238 , 0.000573961 , 0.00019028 , 0.00014756 , 0.000243763 , 0.0001331824 , 0.0001064686 , 9.43785e-05 , 0.00014321475 , 7.804936e-05 , 7.66374e-05 , 6.3764206e-05 , 7.9260528e-05 , 8.0238232e-05 , 6.9090852e-05 , 7.20474195e-05 , 0.0001610639472 , 6.36823034e-05 , 0.000156755344 , 0.000161489037 , 7.11471103e-05 , 0.000177221241 , 6.662111742e-05 , 0.000135475660062 , 7.8416485686e-05 , 8.5552088139e-05 , 0.000275931518139 , 0.000246257404598 , 0.000453077189226 , 0.00022270795668 , 0.0004239267548 , 0.0002234288237 , 0.0004723671705 , 0.000458520914 , 0.0002045544204 , 0.0004627769094 , 0.0002126349885 , 0.000204838444 , 0.00022170898 , 0.00021809304 , 0.000193299638 , 0.0002136603 , 0.00021478304 , 0.00040825575 , 0.00024209833 , 0.000261797 , 0.0003121968 , 0.0005884505 , 0.00034867 , 0.00043684 , 0.001238208 , 0.00083594 , 0.0016533 , 0.005439 }; 
  //
  //  // Up central
  //  Double_t xsUp2017[nm2017] = { 0.0012691 , 0.0006012 , 0.00037532 , 0.000561063 , 0.00021976 , 0.0002142 , 0.0003457905 , 0.000153672 , 0.000122486 , 0.00013038215 , 0.00025184775 , 0.00010845208 , 0.00012578715 , 0.000127829465 , 0.00011295924 , 0.000117489216 , 0.000124880574 , 0.000108148254 , 0.0002593058178 , 0.0001298881228 , 0.000235212092 , 0.000509878911 , 0.0001146094502 , 0.0001157330071 , 0.0001313832267 , 0.000263204509708 , 0.000126753672346 , 0.000136988113423 }; 
  //
  //  // Up error (low to high)
  //  Double_t xsUp2017_1sigma[nm2017_2]={0.0009065 , 0.0004008 , 0.0002559 , 0.000367593 , 0.00014472 , 0.00014161 , 0.0002233575 , 9.78648e-05 , 7.37608e-05 , 7.990713e-05 , 0.00015372525 , 6.34372e-05 , 7.741485e-05 , 7.8350519e-05 , 6.6953544e-05 , 6.9944764e-05 , 7.558147e-05 , 6.1315056e-05 , 0.0001543743084 , 7.76641825e-05 , 0.000136369636 , 0.0003363508185 , 6.34884733e-05 , 6.44004994e-05 , 7.552289712e-05 , 0.000149916051424 , 7.1198366882e-05 , 7.4794137507e-05 , 0.00025820911157 , 0.00023487623271 , 0.000479328266253 , 0.00023717046936 , 0.0002153774214 , 0.0002123728138 , 0.0008005119825 , 0.000424600384 , 0.000226187801 , 0.0004515562052 , 0.0001960886505 , 0.000215477264 , 0.000205533008 , 0.000198506424 , 0.000216486622 , 0.00021303195 , 0.00019231488 , 0.0004265205 , 0.00022077578 , 0.000211322 , 0.0002504584 , 0.000552603 , 0.00033201 , 0.0003484 , 0.000877064 , 0.0005971 , 0.0009018 , 0.001813}; 
  //
  //
  //  //2018 Nominal values
  //
  //  // Masses
  //  Double_t lqmass2018[nm2018] = {400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0,1600.0,1700.0,1800.0,1900.0,2000.0,2100.0,2200.0,2300.0,2400.0,2500.0,2600.0,2700.0,2800.0,2900.0};
  //
  //  // Nominal central
  //  Double_t xs2018[nm2018] = { 0.0009065 , 0.0004509 , 0.00035826 , 0.000206368 , 0.00018224 , 0.00015113 , 0.000173171 , 0.000137496 , 0.000119794 , 8.151506e-05 , 9.3639e-05 , 7.262872e-05 , 7.528485e-05 , 9.5050106e-05 , 9.2708448e-05 , 9.3021436e-05 , 8.3475662e-05 , 9.1969065e-05 , 8.476237e-05 , 9.459463e-05 , 9.4945578e-05 , 8.1442605e-05 , 0.0001773199148 , 7.28453032e-05 , 7.41527556e-05 , 7.3522780456e-05 }; 
  //
  //  // Nominal error (low to high)
  //  Double_t xs2018_1sigma[nm2018_2]={ 0.0007252 , 0.0003006 , 0.0002559 , 0.000141878 , 0.00012328 , 0.00010115 , 0.000118021 , 9.11248e-05 , 7.84718e-05 , 4.956619e-05 , 5.85795e-05 , 4.305088e-05 , 4.51773e-05 , 6.0139764e-05 , 5.8424472e-05 , 5.8620304e-05 , 5.0949632e-05 , 5.7492249e-05 , 5.1734784e-05 , 5.87059894e-05 , 5.8923704e-05 , 4.84858005e-05 , 0.0001185848557 , 4.14912413e-05 , 4.243055058e-05 , 4.1491190283e-05 , 0.000255934677971 , 0.00023667738402 , 0.0002395119822 , 0.0002313224144 , 0.000484636605 , 0.000244445434 , 0.0002796472592 , 0.0002802097068 , 0.0002586283185 , 0.000272815398 , 0.000249180164 , 0.000278026704 , 0.000275245084 , 0.0002808618 , 0.0002417684 , 0.00023773575 , 0.00029453083 , 0.0002682578 , 0.0003795968 , 0.0004362365 , 0.00056644 , 0.00052796 , 0.000677145 , 0.00083594 , 0.0015531 , 0.0023569 }; 
  //
  //  //2018 Study values
  //
  //  // Down central
  //  Double_t xsDown2018[nm2018] = {0.0029008 , 0.0009519 , 0.00047768 , 0.000348246 , 0.00020636 , 0.00018088 , 0.000146699 , 0.000169848 , 0.0001356768 , 0.00011835763 , 8.051925e-05 , 9.061896e-05 , 7.236675e-05 , 7.4985809e-05 , 9.591096e-05 , 9.4255336e-05 , 9.4120734e-05 , 8.48296005e-05 , 9.33697184e-05 , 8.69038614e-05 , 9.5814354e-05 , 9.6926214e-05 , 8.21590512e-05 , 0.0001828177379 , 7.389148668e-05 , 7.6502454924e-05 }; 
  //
  //  // Down error (low to high)
  //  Double_t xsDown2018_1sigma[nm2018_2]={0.0019943 , 0.0006513 , 0.00032414 , 0.000245062 , 0.00013936 , 0.00012138 , 9.7064e-05 , 0.0001148496 , 8.97782e-05 , 7.746028e-05 , 4.8951e-05 , 5.687744e-05 , 4.28982e-05 , 4.4998569e-05 , 6.0686616e-05 , 5.9397204e-05 , 5.889384e-05 , 5.177622e-05 , 5.79459812e-05 , 5.26387572e-05 , 5.9462926e-05 , 5.9904444e-05 , 4.89123219e-05 , 0.000121513977 , 4.20871176e-05 , 4.357427187e-05 , 4.2211567996e-05 , 0.0001345656114 , 0.0002826522967 , 0.0001437270877 , 0.000162606 , 0.000160740838 , 0.00014856363 , 0.0001558953978 , 0.00014501799 , 0.00015639899 , 0.000156621212 , 0.000157847016 , 0.000130580263 , 0.00012717165 , 0.00015059952 , 0.00013762875 , 0.00018721898 , 0.0002107836 , 0.0002577376 , 0.000227218 , 0.00027846 , 0.00031624 , 0.000509471 , 0.00069946 , 0.0013527 , 0.0041699 }; 
  //  
  //  // Up central
  //  Double_t xsUp2018[nm2018] = {0.0010878 , 0.0005511 , 0.00029002 , 0.000232164 , 0.00017152 , 0.00018445 , 0.000146699 , 0.0001250944 , 8.38558e-05 , 9.542715e-05 , 7.4235e-05 , 7.6105e-05 , 9.53814e-05 , 9.2535428e-05 , 9.3047112e-05 , 8.3369596e-05 , 9.1057254e-05 , 8.46642075e-05 , 9.28692606e-05 , 9.42992893e-05 , 8.0568162e-05 , 0.000177807939 , 7.20208563e-05 , 7.36744566e-05 , 7.146458946e-05 , 8.0992641913e-05 };
  //
  //  // Up error (low to high)
  //  Double_t xsUp2018_1sigma[nm2018_2]={0.0007252 , 0.0004008 , 0.00018766 , 0.000154776 , 0.00011524 , 0.00012495 , 9.76155e-05 , 8.19584e-05 , 5.10134e-05 , 5.970314e-05 , 4.3806e-05 , 4.5663e-05 , 6.03429e-05 , 5.8315737e-05 , 5.8223904e-05 , 5.1098084e-05 , 5.6921334e-05 , 5.1675342e-05 , 5.76351256e-05 , 5.85226809e-05 , 4.7965212e-05 , 0.000118911234 , 4.1021646e-05 , 4.19635081e-05 , 4.032968412e-05 , 4.7377532213e-05 , 0.000144914988274 , 0.00013128537708 , 0.0001335830285 , 0.0001311589906 , 0.000274906722 , 0.000140301706 , 0.0001581991436 , 0.0001558001038 , 0.000144735297 , 0.000152760326 , 0.000142521848 , 0.000153875112 , 0.000153023469 , 0.00015697035 , 0.00013253072 , 0.00012983775 , 0.00015855588 , 0.000144022 , 0.0001978864 , 0.000227218 , 0.00028084 , 0.000268 , 0.000354695 , 0.00044356 , 0.0008016 , 0.0016317 }; 





  // Removing select high masses

  const int nm2016 = 20;
  const int nm2017 = 20;
  const int nm2018 = 18;

  const int nm2016_2 = nm2016*2;
  const int nm2017_2 = nm2017*2;
  const int nm2018_2 = nm2018*2;


  // 2016 Nominal values
  
  // Masses
  Double_t lqmass2016[nm2016] = {400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0,1600.0,1700.0,1800.0,1900.0,2000.0,2500.0,3000.0,3500.0};

  // Nominal central
  Double_t xs2016[nm2016] = { 0.0010878 , 0.0005511 , 0.00046062 , 0.000270858 , 0.00020904 , 0.0001785 , 0.000211776 , 0.000172544 , 0.0001512904 , 0.00013038215 , 0.000115248 , 0.00011186944 , 0.0001132308 , 0.000132705343 , 0.000138717432 , 0.000119443348 , 0.000118198228 , 0.0001455690855 , 0.000163771417832 , 0.00018511751282 };
  
  // Nominal error (low to high)
  Double_t xs2016_1sigma[nm2016_2]={0.0009065 , 0.0004008 , 0.00030708 , 0.000180572 , 0.000134 , 0.00011305 , 0.000138978 , 0.000110536 , 9.422e-05 , 7.732046e-05 , 6.65175e-05 , 6.31426e-05 , 6.39e-05 , 7.8999849e-05 , 8.2223016e-05 , 6.7093084e-05 , 6.4535228e-05 , 7.90927515e-05 , 8.370495111e-05 , 8.95307137605e-05 , 0.00481185984375 , 0.00537097577689 , 0.00105252576 , 0.000424353458 , 0.00039415336 , 0.00040153056 , 0.000437660226 , 0.0004207389 , 0.00038360848 , 0.0003812445 , 0.00039583042 , 0.0004391998 , 0.0005036128 , 0.0005730085 , 0.00071876 , 0.0006566 , 0.000812574 , 0.00112596 , 0.002004 , 0.0029008};
  
  //2016 Study values

  //Down central
  Double_t xsDown2016[nm2016] = { 0.0032634 , 0.0011523 , 0.00058004 , 0.000438532 , 0.00027872 , 0.00020587 , 0.0001748255 , 0.0002070528 , 0.0001730956 , 0.00015142506 , 0.0001300215 , 0.00011493328 , 0.0001127196 , 0.000115627964 , 0.000135758232 , 0.000145640416 , 0.000122902858 , 0.0001470667335 , 0.000162904917264 , 0.000196893287514 }; 

  // Down error (low to high)
  Double_t xsDown2016_1sigma[nm2016_2]={0.0023569 , 0.0008016 , 0.00039238 , 0.000303103 , 0.00018492 , 0.00013328 , 0.0001108515 , 0.0001364176 , 0.000110372 , 9.465814e-05 , 7.706475e-05 , 6.575472e-05 , 6.361245e-05 , 6.5251762e-05 , 8.0470512e-05 , 8.63273e-05 , 6.8082196e-05 , 7.95295245e-05 , 8.2819609232e-05 , 9.79298965485e-05 , 0.000396238875597 , 0.000327838786604 , 0.0002877581925 , 0.000230680044 , 0.000259422448 , 0.000240737496 , 0.000212419455 , 0.00020706795 , 0.00020745732 , 0.0002285115 , 0.00025286447 , 0.000280641 , 0.0003270248 , 0.000284574 , 0.00033201 , 0.00043684 , 0.000657798 , 0.00087006 , 0.0016533 , 0.0048951 };

  // Up central
  Double_t xsUp2016[nm2016] = { 0.0012691 , 0.0006513 , 0.00037532 , 0.000264409 , 0.00020368 , 0.00022372 , 0.0001825465 , 0.0001552896 , 0.0001336578 , 0.00011737889 , 0.0001137045 , 0.00011359776 , 0.0001301217 , 0.000136028732 , 0.0001147512 , 0.000116070688 , 0.00012297163 , 0.0003292153425 , 0.000155972775894 , 0.000187361346861 };

  // Up error (low to high)
  Double_t xsUp2016_1sigma[nm2016_2]={0.0009065 , 0.0004509 , 0.0002559 , 0.000167674 , 0.00012864 , 0.00014637 , 0.0001163665 , 9.7056e-05 , 7.92794e-05 , 6.746315e-05 , 6.44595e-05 , 6.410496e-05 , 7.74681e-05 , 8.0983257e-05 , 6.4454664e-05 , 6.3682036e-05 , 6.875116e-05 , 0.0002060007075 , 7.7160541342e-05 , 9.11305324755e-05 , 0.000377056242486 , 0.000313888155564 , 0.0005627988 , 0.000230809252 , 0.00021970732 , 0.00021263496 , 0.000239047888 , 0.00022866615 , 0.00020869464 , 0.0002070495 , 0.00021189721 , 0.000232858 , 0.0002580072 , 0.000294501 , 0.00035105 , 0.00033232 , 0.000419185 , 0.0005971 , 0.001002 , 0.0019943};


  //2017 Nominal values

  // Masses
  Double_t lqmass2017[nm2017] = {400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0,1600.0,1700.0,1800.0,1900.0,2000.0,2500.0,3000.0,3500.0};

  // Nominal central
  Double_t xs2017[nm2017] = { 0.0010878 , 0.000501 , 0.00044356 , 0.000561063 , 0.0002278 , 0.00019278 , 0.000401492 , 0.0001668824 , 0.0001483292 , 0.00011975583 , 0.00025368525 , 0.00012396768 , 0.00010804425 , 0.000127451673 , 0.000127814424 , 0.000114520544 , 0.000118342024 , 0.0002391718395 , 0.00013244621823 , 0.000142927861865 };

  // Nominal error (low to high)
  Double_t xs2017_1sigma[nm2017_2]={0.0007252 , 0.0003507 , 0.00030708 , 0.000380491 , 0.00015008 , 0.00012614 , 0.0002663745 , 0.00010784 , 9.422e-05 , 7.249667e-05 , 0.00015615075 , 7.565328e-05 , 6.320775e-05 , 7.8444967e-05 , 7.86654e-05 , 6.7880952e-05 , 7.0453788e-05 , 0.0001386653415 , 7.578633126e-05 , 7.9908401745e-05 , 0.000265837641903 , 0.00381834303033 , 0.0007240479255 , 0.000391115742 , 0.00036318704 , 0.000360345072 , 0.000388618102 , 0.0003894279 , 0.0003517524 , 0.000394695 , 0.00081731781 , 0.0003978776 , 0.0004842016 , 0.000545985 , 0.00134232 , 0.00068608 , 0.000857717 , 0.00226898 , 0.0018537 , 0.0029008}; 

  //2017 Study values

  // Down central
  Double_t xsDown2017[nm2017] = {0.0038073 , 0.0011523 , 0.00056298 , 0.000831921 , 0.00028408 , 0.00022372 , 0.0003722625 , 0.0002003128 , 0.0001638082 , 0.00014855875 , 0.00023663325 , 0.00012681548 , 0.0001255635 , 0.000109004798 , 0.000128777808 , 0.00013091222 , 0.000116561246 , 0.0002712565125 , 0.000136417045576 , 0.000150202041552 };   

  // Down error (low to high)
  Double_t xsDown2017_1sigma[nm2017_2]={0.0027195 , 0.0008016 , 0.00039238 , 0.000573961 , 0.00019028 , 0.00014756 , 0.000243763 , 0.0001331824 , 0.0001064686 , 9.43785e-05 , 0.00014321475 , 7.804936e-05 , 7.66374e-05 , 6.3764206e-05 , 7.9260528e-05 , 8.0238232e-05 , 6.9090852e-05 , 0.000161489037 , 7.8416485686e-05 , 8.5552088139e-05 , 0.000275931518139 , 0.000246257404598 , 0.0004723671705 , 0.000204838444 , 0.00022170898 , 0.00021809304 , 0.000193299638 , 0.0002136603 , 0.00021478304 , 0.00040825575 , 0.00024209833 , 0.000261797 , 0.0003121968 , 0.0005884505 , 0.00034867 , 0.00043684 , 0.001238208 , 0.00083594 , 0.0016533 , 0.005439 }; 

  // Up central
  Double_t xsUp2017[nm2017] = { 0.0012691 , 0.0006012 , 0.00037532 , 0.000561063 , 0.00021976 , 0.0002142 , 0.0003457905 , 0.000153672 , 0.000122486 , 0.00013038215 , 0.00025184775 , 0.00010845208 , 0.00012578715 , 0.000127829465 , 0.00011295924 , 0.000117489216 , 0.000124880574 , 0.000509878911 , 0.000126753672346 , 0.000136988113423 }; 

  // Up error (low to high)
  Double_t xsUp2017_1sigma[nm2017_2]={0.0009065 , 0.0004008 , 0.0002559 , 0.000367593 , 0.00014472 , 0.00014161 , 0.0002233575 , 9.78648e-05 , 7.37608e-05 , 7.990713e-05 , 0.00015372525 , 6.34372e-05 , 7.741485e-05 , 7.8350519e-05 , 6.6953544e-05 , 6.9944764e-05 , 7.558147e-05 , 0.0003363508185 , 7.1198366882e-05 , 7.4794137507e-05 , 0.00025820911157 , 0.00023487623271 , 0.0008005119825 , 0.000215477264 , 0.000205533008 , 0.000198506424 , 0.000216486622 , 0.00021303195 , 0.00019231488 , 0.0004265205 , 0.00022077578 , 0.000211322 , 0.0002504584 , 0.000552603 , 0.00033201 , 0.0003484 , 0.000877064 , 0.0005971 , 0.0009018 , 0.001813}; 


  //2018 Nominal values

  // Masses
  Double_t lqmass2018[nm2018] = {400.0,500.0,600.0,700.0,800.0,900.0,1000.0,1100.0,1200.0,1300.0,1400.0,1500.0,1600.0,1700.0,1800.0,1900.0,2000.0,2500.0};

  // Nominal central
  Double_t xs2018[nm2018] = { 0.0009065 , 0.0004509 , 0.00035826 , 0.000206368 , 0.00018224 , 0.00015113 , 0.000173171 , 0.000137496 , 0.000119794 , 8.151506e-05 , 9.3639e-05 , 7.262872e-05 , 7.528485e-05 , 9.5050106e-05 , 9.2708448e-05 , 9.3021436e-05 , 8.3475662e-05 , 8.1442605e-05 }; 

  // Nominal error (low to high)
  Double_t xs2018_1sigma[nm2018_2]={ 0.0007252 , 0.0003006 , 0.0002559 , 0.000141878 , 0.00012328 , 0.00010115 , 0.000118021 , 9.11248e-05 , 7.84718e-05 , 4.956619e-05 , 5.85795e-05 , 4.305088e-05 , 4.51773e-05 , 6.0139764e-05 , 5.8424472e-05 , 5.8620304e-05 , 5.0949632e-05 , 4.84858005e-05 , 0.000484636605 , 0.000272815398 , 0.000249180164 , 0.000278026704 , 0.000275245084 , 0.0002808618 , 0.0002417684 , 0.00023773575 , 0.00029453083 , 0.0002682578 , 0.0003795968 , 0.0004362365 , 0.00056644 , 0.00052796 , 0.000677145 , 0.00083594 , 0.0015531 , 0.0023569 }; 

  //2018 Study values

  // Down central
  Double_t xsDown2018[nm2018] = {0.0029008 , 0.0009519 , 0.00047768 , 0.000348246 , 0.00020636 , 0.00018088 , 0.000146699 , 0.000169848 , 0.0001356768 , 0.00011835763 , 8.051925e-05 , 9.061896e-05 , 7.236675e-05 , 7.4985809e-05 , 9.591096e-05 , 9.4255336e-05 , 9.4120734e-05 , 9.6926214e-05 }; 

  // Down error (low to high)
  Double_t xsDown2018_1sigma[nm2018_2]={0.0019943 , 0.0006513 , 0.00032414 , 0.000245062 , 0.00013936 , 0.00012138 , 9.7064e-05 , 0.0001148496 , 8.97782e-05 , 7.746028e-05 , 4.8951e-05 , 5.687744e-05 , 4.28982e-05 , 4.4998569e-05 , 6.0686616e-05 , 5.9397204e-05 , 5.889384e-05 , 5.9904444e-05 , 0.000162606 , 0.00015639899 , 0.000156621212 , 0.000157847016 , 0.000130580263 , 0.00012717165 , 0.00015059952 , 0.00013762875 , 0.00018721898 , 0.0002107836 , 0.0002577376 , 0.000227218 , 0.00027846 , 0.00031624 , 0.000509471 , 0.00069946 , 0.0013527 , 0.0041699 }; 
  
  // Up central
  Double_t xsUp2018[nm2018] = {0.0010878 , 0.0005511 , 0.00029002 , 0.000232164 , 0.00017152 , 0.00018445 , 0.000146699 , 0.0001250944 , 8.38558e-05 , 9.542715e-05 , 7.4235e-05 , 7.6105e-05 , 9.53814e-05 , 9.2535428e-05 , 9.3047112e-05 , 8.3369596e-05 , 9.1057254e-05 , 0.000177807939};

  // Up error (low to high)
  Double_t xsUp2018_1sigma[nm2018_2]={0.0007252 , 0.0004008 , 0.00018766 , 0.000154776 , 0.00011524 , 0.00012495 , 9.76155e-05 , 8.19584e-05 , 5.10134e-05 , 5.970314e-05 , 4.3806e-05 , 4.5663e-05 , 6.03429e-05 , 5.8315737e-05 , 5.8223904e-05 , 5.1098084e-05 , 5.6921334e-05 , 0.000118911234 , 0.000274906722 , 0.000152760326 , 0.000142521848 , 0.000153875112 , 0.000153023469 , 0.00015697035 , 0.00013253072 , 0.00012983775 , 0.00015855588 , 0.000144022 , 0.0001978864 , 0.000227218 , 0.00028084 , 0.000268 , 0.000354695 , 0.00044356 , 0.0008016 , 0.0016317 }; 

  Double_t xsRatioUp2016[nm2016];
  Double_t xsRatioDown2016[nm2016];
  Double_t xsRatio2016ErrHigh[nm2016];
  Double_t xsRatio2016ErrLow[nm2016];

  Double_t xsRatioUp2017[nm2017];
  Double_t xsRatioDown2017[nm2017];
  Double_t xsRatio2017ErrHigh[nm2017];
  Double_t xsRatio2017ErrLow[nm2017];

  Double_t xsRatioUp2018[nm2018];
  Double_t xsRatioDown2018[nm2018];
  Double_t xsRatio2018ErrHigh[nm2018];
  Double_t xsRatio2018ErrLow[nm2018];

  Double_t meanRatio2016[nm2016];
  Double_t meanRatio2016ErrLow[nm2016];
  Double_t meanRatio2016ErrHigh[nm2016];

  Double_t meanRatio2017[nm2017];
  Double_t meanRatio2017ErrLow[nm2017];
  Double_t meanRatio2017ErrHigh[nm2017];

  Double_t meanRatio2018[nm2018];
  Double_t meanRatio2018ErrLow[nm2018];
  Double_t meanRatio2018ErrHigh[nm2018];

  for(int i=0;i<nm2016;i++){

    Double_t ratioUp = xsUp2016[i]/xs2016[i];
    Double_t ratioDown = xsDown2016[i]/xs2016[i];

    int j = nm2016_2-1-i;
    int k = nm2016-1-i;

    Double_t ErrHigh = fabs(xs2016_1sigma[j]-xs2016[k]);
    Double_t ErrLow = fabs(xs2016[i]-xs2016_1sigma[i]);

    Double_t downErrHigh = fabs(xsDown2016_1sigma[j]-xsDown2016[k]);
    Double_t downErrLow = fabs(xsDown2016[i]-xsDown2016_1sigma[i]);

    Double_t upErrHigh = fabs(xsUp2016_1sigma[j]-xsUp2016[k]);
    Double_t upErrLow = fabs(xsUp2016[i]-xsUp2016_1sigma[i]);

    Double_t ratioDownErrHigh = ratioDown*sqrt( ((downErrHigh/xsDown2016[i])*(downErrHigh/xsDown2016[i])) + ((ErrHigh/xs2016[i])*(ErrHigh/xs2016[i])) );
    Double_t ratioDownErrLow = ratioDown*sqrt( ((downErrLow/xsDown2016[i])*(downErrLow/xsDown2016[i])) + ((ErrLow/xs2016[i])*(ErrLow/xs2016[i])) );

    Double_t ratioUpErrHigh = ratioUp*sqrt( ((upErrHigh/xsUp2016[i])*(upErrHigh/xsUp2016[i])) + ((ErrHigh/xs2016[i])*(ErrHigh/xs2016[i])) );
    Double_t ratioUpErrLow = ratioUp*sqrt( ((upErrLow/xsUp2016[i])*(upErrLow/xsUp2016[i])) + ((ErrLow/xs2016[i])*(ErrLow/xs2016[i])) );

    Double_t meanRatio = 0.5*(ratioUp + ratioDown);

    Double_t meanRatioErrHigh = 0.5*sqrt( ((ratioUpErrHigh)*(ratioUpErrHigh)) + ((ratioDownErrHigh)*(ratioDownErrHigh)) );
    Double_t meanRatioErrLow = 0.5*sqrt( ((ratioUpErrLow)*(ratioUpErrLow)) + ((ratioDownErrLow)*(ratioDownErrLow)) );

    xsRatioUp2016[i] = ratioUp;
    xsRatioDown2016[i] = ratioDown;
    meanRatio2016[i] = meanRatio;
    meanRatio2016ErrLow[i] = meanRatio-meanRatioErrLow;
    meanRatio2016ErrHigh[i] = meanRatio+meanRatioErrHigh;

  }

  for(int i=0;i<nm2017;i++){

    Double_t ratioUp = xsUp2017[i]/xs2017[i];
    Double_t ratioDown = xsDown2017[i]/xs2017[i];

    int j = nm2017_2-1-i;
    int k = nm2017-1-i;

    Double_t ErrHigh = fabs(xs2017_1sigma[j]-xs2017[k]);
    Double_t ErrLow = fabs(xs2017[i]-xs2017_1sigma[i]);

    Double_t downErrHigh = fabs(xsDown2017_1sigma[j]-xsDown2017[k]);
    Double_t downErrLow = fabs(xsDown2017[i]-xsDown2017_1sigma[i]);

    Double_t upErrHigh = fabs(xsUp2017_1sigma[j]-xsUp2017[k]);
    Double_t upErrLow = fabs(xsUp2017[i]-xsUp2017_1sigma[i]);

    Double_t ratioDownErrHigh = ratioDown*sqrt( ((downErrHigh/xsDown2017[i])*(downErrHigh/xsDown2017[i])) + ((ErrHigh/xs2017[i])*(ErrHigh/xs2017[i])) );
    Double_t ratioDownErrLow = ratioDown*sqrt( ((downErrLow/xsDown2017[i])*(downErrLow/xsDown2017[i])) + ((ErrLow/xs2017[i])*(ErrLow/xs2017[i])) );

    Double_t ratioUpErrHigh = ratioUp*sqrt( ((upErrHigh/xsUp2017[i])*(upErrHigh/xsUp2017[i])) + ((ErrHigh/xs2017[i])*(ErrHigh/xs2017[i])) );
    Double_t ratioUpErrLow = ratioUp*sqrt( ((upErrLow/xsUp2017[i])*(upErrLow/xsUp2017[i])) + ((ErrLow/xs2017[i])*(ErrLow/xs2017[i])) );

    Double_t meanRatio = 0.5*(ratioUp + ratioDown);

    Double_t meanRatioErrHigh = 0.5*sqrt( ((ratioUpErrHigh)*(ratioUpErrHigh)) + ((ratioDownErrHigh)*(ratioDownErrHigh)) );
    Double_t meanRatioErrLow = 0.5*sqrt( ((ratioUpErrLow)*(ratioUpErrLow)) + ((ratioDownErrLow)*(ratioDownErrLow)) );

    xsRatioUp2017[i] = ratioUp;
    xsRatioDown2017[i] = ratioDown;
    meanRatio2017[i] = meanRatio;
    meanRatio2017ErrLow[i] = meanRatio-meanRatioErrLow;
    meanRatio2017ErrHigh[i] = meanRatio+meanRatioErrHigh;

  }

  for(int i=0;i<nm2018;i++){

    Double_t ratioUp = xsUp2018[i]/xs2018[i];
    Double_t ratioDown = xsDown2018[i]/xs2018[i];

    int j = nm2018_2-1-i;
    int k = nm2018-1-i;

    Double_t ErrHigh = fabs(xs2018_1sigma[j]-xs2018[k]);
    Double_t ErrLow = fabs(xs2018[i]-xs2018_1sigma[i]);

    Double_t downErrHigh = fabs(xsDown2018_1sigma[j]-xsDown2018[k]);
    Double_t downErrLow = fabs(xsDown2018[i]-xsDown2018_1sigma[i]);

    Double_t upErrHigh = fabs(xsUp2018_1sigma[j]-xsUp2018[k]);
    Double_t upErrLow = fabs(xsUp2018[i]-xsUp2018_1sigma[i]);

    Double_t ratioDownErrHigh = ratioDown*sqrt( ((downErrHigh/xsDown2018[i])*(downErrHigh/xsDown2018[i])) + ((ErrHigh/xs2018[i])*(ErrHigh/xs2018[i])) );
    Double_t ratioDownErrLow = ratioDown*sqrt( ((downErrLow/xsDown2018[i])*(downErrLow/xsDown2018[i])) + ((ErrLow/xs2018[i])*(ErrLow/xs2018[i])) );

    Double_t ratioUpErrHigh = ratioUp*sqrt( ((upErrHigh/xsUp2018[i])*(upErrHigh/xsUp2018[i])) + ((ErrHigh/xs2018[i])*(ErrHigh/xs2018[i])) );
    Double_t ratioUpErrLow = ratioUp*sqrt( ((upErrLow/xsUp2018[i])*(upErrLow/xsUp2018[i])) + ((ErrLow/xs2018[i])*(ErrLow/xs2018[i])) );

    Double_t meanRatio = 0.5*(ratioUp + ratioDown);

    Double_t meanRatioErrHigh = 0.5*sqrt( ((ratioUpErrHigh)*(ratioUpErrHigh)) + ((ratioDownErrHigh)*(ratioDownErrHigh)) );
    Double_t meanRatioErrLow = 0.5*sqrt( ((ratioUpErrLow)*(ratioUpErrLow)) + ((ratioDownErrLow)*(ratioDownErrLow)) );

    xsRatioUp2018[i] = ratioUp;
    xsRatioDown2018[i] = ratioDown;
    meanRatio2018[i] = meanRatio;
    meanRatio2018ErrLow[i] = meanRatio-meanRatioErrLow;
    meanRatio2018ErrHigh[i] = meanRatio+meanRatioErrHigh;

  }

  setTDRStyle();
  gStyle->SetPadLeftMargin(0.14);
  gROOT->ForceStyle();

  TGraph* g_meanRatio2016 = new TGraph(nm2016,lqmass2016,meanRatio2016);
  TGraph* g_meanRatio2017 = new TGraph(nm2017,lqmass2017,meanRatio2017);
  TGraph* g_meanRatio2018 = new TGraph(nm2018,lqmass2018,meanRatio2018);

  g_meanRatio2016->SetMarkerStyle(0);
  g_meanRatio2016->SetMarkerColor(kBlue);
  g_meanRatio2016->SetLineColor(kBlue);
  g_meanRatio2016->SetLineWidth(2);
  g_meanRatio2016->SetLineStyle(1);
  g_meanRatio2016->SetMarkerSize(0.001);

  g_meanRatio2017->SetMarkerStyle(0);
  g_meanRatio2017->SetMarkerColor(kRed);
  g_meanRatio2017->SetLineColor(kRed);
  g_meanRatio2017->SetLineWidth(2);
  g_meanRatio2017->SetLineStyle(1);
  g_meanRatio2017->SetMarkerSize(0.001);

  g_meanRatio2018->SetMarkerStyle(0);
  g_meanRatio2018->SetMarkerColor(kGreen);
  g_meanRatio2018->SetLineColor(kGreen);
  g_meanRatio2018->SetLineWidth(2);
  g_meanRatio2018->SetLineStyle(1);
  g_meanRatio2018->SetMarkerSize(0.001);

  TGraph *g_meanRatio2016ErrBands = new TGraph(2*nm2016);
  for (int i=0;i<nm2016;i++) {
    g_meanRatio2016ErrBands->SetPoint(i,lqmass2016[i], meanRatio2016ErrHigh[i]);
    g_meanRatio2016ErrBands->SetPoint(nm2016+i,lqmass2016[nm2016-i-1], meanRatio2016ErrLow[nm2016-i-1]);
  }
  g_meanRatio2016ErrBands->SetFillStyle(3013);
  g_meanRatio2016ErrBands->SetFillColor(kBlue);
  g_meanRatio2016ErrBands->SetLineColor(kBlue);
  g_meanRatio2016ErrBands->SetLineStyle(7);
  g_meanRatio2016ErrBands->Draw("l");
  gPad->RedrawAxis();

  TGraph *g_meanRatio2017ErrBands = new TGraph(2*nm2017);
  for (int i=0;i<nm2017;i++) {
    g_meanRatio2017ErrBands->SetPoint(i,lqmass2017[i], meanRatio2017ErrHigh[i]);
    g_meanRatio2017ErrBands->SetPoint(nm2017+i,lqmass2017[nm2017-i-1], meanRatio2017ErrLow[nm2017-i-1]);
  }
  g_meanRatio2017ErrBands->SetFillStyle(3013);
  g_meanRatio2017ErrBands->SetFillColor(kRed);
  g_meanRatio2017ErrBands->SetLineColor(kRed);
  g_meanRatio2017ErrBands->SetLineStyle(7);
  g_meanRatio2017ErrBands->Draw("l");
  gPad->RedrawAxis();

  TGraph *g_meanRatio2018ErrBands = new TGraph(2*nm2018);
  for (int i=0;i<nm2018;i++) {
    g_meanRatio2018ErrBands->SetPoint(i,lqmass2018[i], meanRatio2018ErrHigh[i]);
    g_meanRatio2018ErrBands->SetPoint(nm2018+i,lqmass2018[nm2018-i-1], meanRatio2018ErrLow[nm2018-i-1]);
  }
  g_meanRatio2018ErrBands->SetFillStyle(3013);
  g_meanRatio2018ErrBands->SetFillColor(kGreen);
  g_meanRatio2018ErrBands->SetLineColor(kGreen);
  g_meanRatio2018ErrBands->SetLineStyle(7);
  g_meanRatio2018ErrBands->Draw("l");
  gPad->RedrawAxis();

  setTDRStyle();
  gStyle->SetPadLeftMargin(0.14);
  gROOT->ForceStyle();

  g_meanRatio2016->Draw("L");
  g_meanRatio2017->Draw("L");
  g_meanRatio2018->Draw("L");

  TLegend* leg2 = new TLegend(0.675,0.5,0.875,0.85);
  leg2->AddEntry(g_meanRatio2016,"2016 Central","L");
  leg2->AddEntry(g_meanRatio2016ErrBands,"2016 Syst. Error","l");
  leg2->AddEntry(g_meanRatio2017,"2017 Central","L");
  leg2->AddEntry(g_meanRatio2017ErrBands,"2017 Syst. Error","l");
  leg2->AddEntry(g_meanRatio2018,"2018 Central","L");
  leg2->AddEntry(g_meanRatio2018ErrBands,"2018 Syst. Error","l");
  leg2->SetBorderSize(0);

  g_meanRatio2016->GetXaxis()->SetTitle("M_{LQ} [GeV]");
  g_meanRatio2016->GetYaxis()->SetTitle("Average Exp. Limit Ratio");

  leg2->Draw();
  c2->SetLogy();
  
  c2->Print("BDTStudyLimitAverageRatio2016_RmHighMass.pdf");

return;

}

void setTDRStyle() {
  TStyle *tdrStyle = new TStyle("tdrStyle","Style for P-TDR");

  // For the canvas:
  tdrStyle->SetCanvasBorderMode(0);
  tdrStyle->SetCanvasColor(kWhite);
  tdrStyle->SetCanvasDefH(600); //Height of canvas
  tdrStyle->SetCanvasDefW(600); //Width of canvas
  tdrStyle->SetCanvasDefX(0);   //POsition on screen
  tdrStyle->SetCanvasDefY(0);

  // For the Pad:
  tdrStyle->SetPadBorderMode(0);
  // tdrStyle->SetPadBorderSize(Width_t size = 1);
  tdrStyle->SetPadColor(kWhite);
  tdrStyle->SetPadGridX(false);
  tdrStyle->SetPadGridY(false);
  tdrStyle->SetGridColor(0);
  tdrStyle->SetGridStyle(3);
  tdrStyle->SetGridWidth(1);

  // For the frame:
  tdrStyle->SetFrameBorderMode(0);
  tdrStyle->SetFrameBorderSize(1);
  tdrStyle->SetFrameFillColor(0);
  tdrStyle->SetFrameFillStyle(0);
  tdrStyle->SetFrameLineColor(1);
  tdrStyle->SetFrameLineStyle(1);
  tdrStyle->SetFrameLineWidth(1);

  // For the histo:
  tdrStyle->SetHistFillColor(63);
  // tdrStyle->SetHistFillStyle(0);
  tdrStyle->SetHistLineColor(1);
  tdrStyle->SetHistLineStyle(0);
  tdrStyle->SetHistLineWidth(1);


  tdrStyle->SetMarkerStyle(20);

  //For the fit/function:
  tdrStyle->SetOptFit(1);
  tdrStyle->SetFitFormat("5.4g");
  tdrStyle->SetFuncColor(2);
  tdrStyle->SetFuncStyle(1);
  tdrStyle->SetFuncWidth(1);

  //For the date:
  tdrStyle->SetOptDate(0);

  // For the statistics box:
  tdrStyle->SetOptFile(0);
  tdrStyle->SetOptStat(0); // To display the mean and RMS:   SetOptStat("mr");
  tdrStyle->SetStatColor(kWhite);
  tdrStyle->SetStatFont(42);
  tdrStyle->SetStatFontSize(0.025);
  tdrStyle->SetStatTextColor(1);
  tdrStyle->SetStatFormat("6.4g");
  tdrStyle->SetStatBorderSize(1);
  tdrStyle->SetStatH(0.1);
  tdrStyle->SetStatW(0.15);


  // Margins:
  tdrStyle->SetPadTopMargin(0.1);
  tdrStyle->SetPadBottomMargin(0.13);
  tdrStyle->SetPadLeftMargin(0.13);
  tdrStyle->SetPadRightMargin(0.05);

  // For the Global title:

  //  tdrStyle->SetOptTitle(0);
  tdrStyle->SetTitleFont(42);
  tdrStyle->SetTitleColor(1);
  tdrStyle->SetTitleTextColor(1);
  tdrStyle->SetTitleFillColor(10);
  tdrStyle->SetTitleFontSize(0.05);

  // For the axis titles:

  tdrStyle->SetTitleColor(1, "XYZ");
  tdrStyle->SetTitleFont(42, "XYZ");
  tdrStyle->SetTitleSize(0.06, "XYZ");
  tdrStyle->SetTitleXOffset(0.9);
  tdrStyle->SetTitleYOffset(1.05);

  // For the axis labels:

  tdrStyle->SetLabelColor(1, "XYZ");
  tdrStyle->SetLabelFont(42, "XYZ");
  tdrStyle->SetLabelOffset(0.007, "XYZ");
  tdrStyle->SetLabelSize(0.04, "XYZ");

  // For the axis:

  tdrStyle->SetAxisColor(1, "XYZ");
  tdrStyle->SetStripDecimals(kTRUE);
  tdrStyle->SetTickLength(0.03, "XYZ");
  tdrStyle->SetNdivisions(510, "XYZ");
  tdrStyle->SetPadTickX(1);  // To get tick marks on the opposite side of the frame
  tdrStyle->SetPadTickY(1);

  // Change for log plots:
  tdrStyle->SetOptLogx(0);
  tdrStyle->SetOptLogy(0);
  tdrStyle->SetOptLogz(0);
  
  tdrStyle->cd();
}
