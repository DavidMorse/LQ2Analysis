#include "TROOT.h"
#include "TStyle.h"
#include "TCanvas.h"
#include "TH2F.h"
#include "TGraph.h"
#include "TF1.h"
#include "TLegend.h"
#include "TPolyLine.h"
#include "TPad.h"
#include "TLatex.h"
#include "TMath.h"
#include "stdio.h"
using namespace std;
void myStyle();
void setTDRStyle();
void makePlotsRPV()
{

Double_t mTh[221] = {100,105,110,115,120,125,130,135,140,145,150,155,160,165,170,175,180,185,190,195,200,205,210,215,220,225,230,235,240,245,250,255,260,265,270,275,280,285,290,295,300,305,310,315,320,325,330,335,340,345,350,355,360,365,370,375,380,385,390,395,400,405,410,415,420,425,430,435,440,445,450,455,460,465,470,475,480,485,490,495,500,505,510,515,520,525,530,535,540,545,550,555,560,565,570,575,580,585,590,595,600,605,610,615,620,625,630,635,640,645,650,655,660,665,670,675,680,685,690,695,700,705,710,715,720,725,730,735,740,745,750,755,760,765,770,775,780,785,790,795,800,805,810,815,820,825,830,835,840,845,850,855,860,865,870,875,880,885,890,895,900,905,910,915,920,925,930,935,940,945,950,955,960,965,970,975,980,985,990,995,1000,1005,1010,1015,1020,1025,1030,1035,1040,1045,1050,1055,1060,1065,1070,1075,1080,1085,1090,1095,1100,1105,1110,1115,1120,1125,1130,1135,1140,1145,1150,1155,1160,1165,1170,1175,1180,1185,1190,1195,1200};
Double_t xsTh[221] = {559.757,448.456,361.917,293.281,240.077,197.122,163.376,135.791,113.319,95.0292,80.268,68.0456,58.01,49.6639,42.6441,36.7994,31.8695,27.7028,24.1585,21.1597,18.5245,16.2439,14.3201,12.6497,11.1808,9.90959,8.78125,7.81646,6.96892,6.22701,5.57596,5.00108,4.48773,4.03416,3.63085,3.2781,2.95613,2.67442,2.42299,2.19684,1.99608,1.81486,1.64956,1.50385,1.3733,1.25277,1.14277,1.04713,0.959617,0.879793,0.807323,0.74141,0.681346,0.626913,0.576882,0.531443,0.489973,0.452072,0.4176,0.385775,0.35683,0.329881,0.305512,0.283519,0.262683,0.243755,0.226367,0.209966,0.195812,0.181783,0.169668,0.158567,0.147492,0.137392,0.128326,0.119275,0.112241,0.104155,0.0977878,0.091451,0.0855847,0.0801322,0.0751004,0.0703432,0.0660189,0.0618641,0.0580348,0.0545113,0.0511747,0.0481537,0.0452067,0.0424781,0.0399591,0.0376398,0.0354242,0.0333988,0.0313654,0.0295471,0.0279395,0.0263263,0.0248009,0.0233806,0.0220672,0.0208461,0.0196331,0.0185257,0.0175075,0.0164955,0.0155809,0.0147721,0.0139566,0.0132456,0.0125393,0.0118287,0.0112223,0.0106123,0.0100516,0.0095256,0.0090306,0.00856339,0.0081141,0.00769525,0.00730084,0.00692243,0.00656729,0.00623244,0.00591771,0.00561049,0.00532605,0.00506044,0.00480639,0.00455979,0.00433688,0.00412174,0.00391839,0.00372717,0.00354211,0.00336904,0.00320476,0.00304935,0.00289588,0.00275424,0.0026184,0.00249291,0.00237168,0.00226163,0.00214607,0.00204589,0.00195172,0.0018573,0.00176742,0.00168383,0.00160403,0.00153063,0.00145772,0.0013878,0.00132077,0.00126234,0.00120568,0.00114627,0.00109501,0.001044,0.000996193,0.00095071,0.000907494,0.000866391,0.000826533,0.000789573,0.000753768,0.000719675,0.000687022,0.000656279,0.000626876,0.000598955,0.000571551,0.000546728,0.000522495,0.000499017,0.000476255,0.000455959,0.000435488,0.000416116,0.00039791,0.000379994,0.000363934,0.000347646,0.00033204,0.000318049,0.000303756,0.000290392,0.000277943,0.000265929,0.000254659,0.000243251,0.00023289,0.000222651,0.000213396,0.000204211,0.000196038,0.000187913,0.000179699,0.000172125,0.000165045,0.000157905,0.000151236,0.000144737,0.000138657,0.000133343,0.000127478,0.00012234,0.000117215,0.000112199,0.000107256,0.000103046,9.86633E-05,9.44977E-05,9.05131E-05,8.67972E-05,8.31669E-05,7.96568E-05,7.63052E-05};
Double_t x_pdf[442] = {100,105,110,115,120,125,130,135,140,145,150,155,160,165,170,175,180,185,190,195,200,205,210,215,220,225,230,235,240,245,250,255,260,265,270,275,280,285,290,295,300,305,310,315,320,325,330,335,340,345,350,355,360,365,370,375,380,385,390,395,400,405,410,415,420,425,430,435,440,445,450,455,460,465,470,475,480,485,490,495,500,505,510,515,520,525,530,535,540,545,550,555,560,565,570,575,580,585,590,595,600,605,610,615,620,625,630,635,640,645,650,655,660,665,670,675,680,685,690,695,700,705,710,715,720,725,730,735,740,745,750,755,760,765,770,775,780,785,790,795,800,805,810,815,820,825,830,835,840,845,850,855,860,865,870,875,880,885,890,895,900,905,910,915,920,925,930,935,940,945,950,955,960,965,970,975,980,985,990,995,1000,1005,1010,1015,1020,1025,1030,1035,1040,1045,1050,1055,1060,1065,1070,1075,1080,1085,1090,1095,1100,1105,1110,1115,1120,1125,1130,1135,1140,1145,1150,1155,1160,1165,1170,1175,1180,1185,1190,1195,1200,1200,1195,1190,1185,1180,1175,1170,1165,1160,1155,1150,1145,1140,1135,1130,1125,1120,1115,1110,1105,1100,1095,1090,1085,1080,1075,1070,1065,1060,1055,1050,1045,1040,1035,1030,1025,1020,1015,1010,1005,1000,995,990,985,980,975,970,965,960,955,950,945,940,935,930,925,920,915,910,905,900,895,890,885,880,875,870,865,860,855,850,845,840,835,830,825,820,815,810,805,800,795,790,785,780,775,770,765,760,755,750,745,740,735,730,725,720,715,710,705,700,695,690,685,680,675,670,665,660,655,650,645,640,635,630,625,620,615,610,605,600,595,590,585,580,575,570,565,560,555,550,545,540,535,530,525,520,515,510,505,500,495,490,485,480,475,470,465,460,455,450,445,440,435,430,425,420,415,410,405,400,395,390,385,380,375,370,365,360,355,350,345,340,335,330,325,320,315,310,305,300,295,290,285,280,275,270,265,260,255,250,245,240,235,230,225,220,215,210,205,200,195,190,185,180,175,170,165,160,155,150,145,140,135,130,125,120,115,110,105,100};
Double_t y_pdf[442] = {649.925456345,520.088773792,420.234133878,340.136452403,278.300139324,228.129881966,189.205908976,157.257656026,131.136599646,109.900319508,92.785473528,78.6084545792,66.93768099,57.2977877329,49.1693722497,42.3836721506,36.7279734055,31.875672764,27.8209286,24.3214246934,21.2873736015,18.699490363,16.4465632495,14.5305712433,12.8479467264,11.39267905858,10.08052375,8.97316320018,7.99946995176,7.14796609797,6.39857580284,5.7376890732,5.14644798486,4.63107045024,4.16300553025,3.7610985321,3.39309331208,3.06932753162,2.77869704695,2.5229938506,2.2893141324,2.07698748924,1.88836515164,1.72123001365,1.5758658699,1.43175951375,1.3093630106,1.19755964867,1.097702047832,1.006378496633,0.923252160831,0.8479357888,0.779021718522,0.716954633451,0.659209983984,0.60725865838,0.560510493026,0.516372008848,0.4773861216,0.4409840318,0.40780245184,0.376747853432,0.349092675776,0.32350084938,0.300266370225,0.27800355252,0.258170205298,0.239431368644,0.223376846864,0.207554557693,0.193823293824,0.181180081303,0.16874633466,0.157282514624,0.146951748944,0.1367683486,0.128662643987,0.119526299055,0.1122581452806,0.105073815313,0.0983891125517,0.0921832014258,0.0864707507608,0.0810451441048,0.0761440866552,0.0713995230535,0.0669966498856,0.0629848635398,0.0591724356401,0.055726350862,0.0523573601859,0.0492330524182,0.0463552332597,0.0436759818066,0.041140603154,0.0388138142416,0.036482194529,0.0344006248344,0.032536832967,0.030687778121,0.0289279185654,0.027292057477,0.0257843536384,0.0243748444236,0.0229797385929,0.0216905379595,0.020509651085,0.0193451471115,0.0182890785526,0.0173555187085,0.01640737896,0.0155785342824,0.0147633078659,0.0139337236233,0.0132307999202,0.0125213572593,0.0118670998888,0.0112565348784,0.0106751445048,0.01013361600735,0.0096082790586,0.00911838644925,0.0086602199038,0.00821695902215,0.0078031883051,0.00740909974224,0.0070418381916,0.00668089855563,0.00634862496975,0.00603667984304,0.00573925262232,0.0054493138332,0.0051882962816,0.00493430394534,0.00469540281861,0.00446923836549,0.00425058867376,0.0040469919192,0.00385299000996,0.00367287803865,0.0034899987408,0.00332008208256,0.0031635613536,0.00301657815333,0.0028717843032,0.00273772799293,0.00260469588935,0.00248171776314,0.00237339496116,0.0022625201421,0.0021533538312,0.00205664848413,0.00195772823918,0.00187266611043,0.00178746501032,0.0017006406516,0.00162740128397,0.00155429778222,0.00149311893472,0.00141831082029,0.00135719809939,0.001295655156,0.00123805770228,0.00118405511453,0.00113218679192,0.00108192308907,0.00103386797652,0.0009892441681,0.00094580396582,0.00090433065085,0.0008645079505,0.00082715567579,0.00079115449768,0.00075687128262,0.00072310860712,0.00069324290308,0.00066316005891,0.00063426857161,0.00060628785516,0.0005811398077,0.00055594180336,0.00053206630728,0.00050931803553,0.000487468843,0.00046730799696,0.00044698758273,0.00042795174624,0.00041021705581,0.00039208794104,0.00037559736868,0.00036028416964,0.00034492613467,0.00033091918414,0.00031680280487,0.00030376355058,0.00029096856489,0.00027939170054,0.00026780250961,0.00025752982757,0.00024721439663,0.00023689557441,0.00022784496075,0.00021876846786,0.00020970541944,0.00020059322972,0.00019281298666,0.00018498299699,0.00017859788074,0.00017075741839,0.00016420817352,0.00015767421876,0.00015109121256,0.00014449281631,0.0001392563644,0.00013343698276,0.00012803587871,0.00012281487205,0.00011790219178,0.00011313268257,0.00010846794765,0.00010408250565,4.85278943492E-05,5.08456523512E-05,5.32011174279E-05,5.56922082192E-05,5.82113279506E-05,6.0959521293E-05,6.38896172416E-05,6.68356356E-05,7.0019183688E-05,7.3306787436E-05,7.6755781235E-05,8.047182648E-05,8.419858161E-05,8.8088119259E-05,9.2331003015E-05,9.6661013343E-05,0.00010187877028,0.00010610458056,0.00011132153214,0.00011640503925,0.00012250242559,0.00012861160337,0.00013454617243,0.00014061949039,0.00014740029946,0.00015433343511,0.00016201644942,0.00016969919513,0.00017839881586,0.00018693186533,0.00019560183036,0.00020518663132,0.00021542405896,0.00022588094419,0.00023612825376,0.00024830441727,0.00026056000304,0.000272519157,0.00028650196447,0.00030016569272,0.00031503419664,0.0003307781923,0.00034622214484,0.00036376542839,0.00038182994109,0.00040021309692,0.00041999339288,0.00044103871738,0.00046259750232,0.00048540232421,0.0005095360495,0.00053501934915,0.00056173203418,0.0005899018319,0.00061919802348,0.00065085891093,0.00068280120808,0.00071736488547,0.00075432829772,0.000792344844,0.00083282190061,0.00087422917971,0.00091824106528,0.00097038221778,0.00101413871603,0.0010749593484,0.00112797498968,0.00118859388957,0.00125033176082,0.00131101151587,0.0013814861688,0.0014520798579,0.00153004503884,0.00161006223686,0.00168744411065,0.00178553200707,0.0018715756968,0.00196924184667,0.0020732386464,0.00218839791744,0.0023017612592,0.00242582196135,0.00255652999004,0.0026910880808,0.00283363132624,0.00298510163451,0.00314137718139,0.00330917605466,0.0034854637184,0.0036702661668,0.00387352737768,0.00408420015696,0.00430347503025,0.00454008144437,0.0047935818084,0.00505578025776,0.0053313916949,0.00562790097785,0.0059414600962,0.00627211355075,0.0066199209414,0.00699316399265,0.0073860554952,0.0077946651216,0.0082361001112,0.0087032427407,0.0092138000798,0.0097236763767,0.0103152921341,0.0109126657176,0.01150582104,0.0121886812915,0.0128727214474,0.0136458528885,0.014505348915,0.0153608620405,0.0162864614071,0.0173173555764,0.0183500463616,0.019469142523,0.0206738814346,0.021964821879,0.023342167033,0.0246935751656,0.026248605471,0.0279837857584,0.029707796846,0.0316036181934,0.0335629667403,0.0357231475818,0.0380560398141,0.040581049138,0.0431769643599,0.0460377364602,0.0490729501144,0.0523286769465,0.0558937133448,0.0596412558952,0.0637300492392,0.0680811985742,0.0727802874483,0.077828184687,0.0833174547194,0.088783700945,0.095819356013,0.1017816514,0.109700251056,0.117501485376,0.12623766534,0.135953918697,0.145512706176,0.156011442307,0.168247153136,0.180500631356,0.194563794702,0.20950644748,0.225099629775,0.24353715062,0.261931324224,0.283014146568,0.30585754816,0.3305659682,0.3578138784,0.387771991152,0.419435506974,0.45562734162,0.494554016016,0.536871366549,0.583670281478,0.6348842112,0.691393839169,0.753207503367,0.821531952168,0.89670035133,0.9761769894,1.07378048625,1.1707341301,1.28646998635,1.41075484836,1.55273251076,1.7028458676,1.8706861494,2.06728295305,2.27951246838,2.51916668792,2.7951014679,3.09869446975,3.43724954976,3.82901201514,4.2644709268,4.75334419716,5.30605390203,5.93837004824,6.65975679982,7.48197625,8.42650094142,9.5136532736,10.7688287567,12.1936367505,13.788309637,15.7616263985,17.9979753066,20.4960714,23.529927236,27.0110265945,31.2151278494,36.1188277503,42.0300122671,49.08231901,57.4827454208,67.750526472,80.158080492,95.501400354,114.324343974,137.546091024,166.114118034,201.853860676,246.425547597,303.599866122,376.823226208,469.588543655};


 // filename for the final plot (NB: changing the name extension changes the file format)
 string fileName2 = "BR_Sigma_MuMuRPV.pdf";
 string fileName3 = "BR_Sigma_MuMuRPV.png";
 string fileName1 = "BR_Sigma_MuMuRPV.eps";

 // axes labels for the final plot
 string title = ";M_{stop} (GeV);#sigma#times#beta^{2} (pb)";

 // integrated luminosity
 string lint = "19.7 fb^{-1}";

Double_t mData[15] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 }; 
Double_t x_shademasses[30] = {300.0 , 350.0 , 400.0 , 450.0 , 500.0 , 550.0 , 600.0 , 650.0 , 700.0 , 750.0 , 800.0 , 850.0 , 900.0 , 950.0 , 1000.0 , 1000.0 , 950.0 , 900.0 , 850.0 , 800.0 , 750.0 , 700.0 , 650.0 , 600.0 , 550.0 , 500.0 , 450.0 , 400.0 , 350.0 , 300.0 }; 
Double_t xsUp_expected[15] = {0.0831425346046 , 0.0311996286616 , 0.0191949822386 , 0.0125423914872 , 0.00931554600852 , 0.00639917967319 , 0.00472767925078 , 0.0037194242839 , 0.0029874542308 , 0.00231977554029 , 0.0019065398535 , 0.00164746127032 , 0.00145104611978 , 0.00162119740198 , 0.00206184926239 }; 
Double_t xsUp_observed[15] = {0.121190166795 , 0.026840100608 , 0.0202775487931 , 0.0122195679163 , 0.00771836912986 , 0.00787246765363 , 0.00469369256864 , 0.00273056227265 , 0.00219423303267 , 0.00245100596373 , 0.00265955595269 , 0.00226684763014 , 0.00210138794477 , 0.00169917978799 , 0.00165608770245 }; 
Double_t y_1sigma[30]={0.0596394431306 , 0.022267867971 , 0.0137458694894 , 0.00898183012057 , 0.0066487122927 , 0.0045672369244 , 0.00335423122652 , 0.00264127022078 , 0.00211789889042 , 0.00162470306003 , 0.00131772805315 , 0.00111601323018 , 0.000941410930292 , 0.00102781877188 , 0.00123506139623 , 0.00362338711303 , 0.002693916294 , 0.00231863597198 , 0.00249458497819 , 0.00282608530437 , 0.003373902248 , 0.00428543936592 , 0.00530578312119 , 0.00670637592851 , 0.00907745694362 , 0.0131401596181 , 0.0176918264853 , 0.0269992086708 , 0.0437602965493 , 0.116614917893 }; 
Double_t y_2sigma[30]={0.0448190222016 , 0.0166357397188 , 0.0103098046213 , 0.00673663587275 , 0.0049670781213 , 0.00341206256978 , 0.00250234580684 , 0.00196141506548 , 0.00156958042014 , 0.00120066506995 , 0.000964441025654 , 0.00080764212727 , 0.000660339376882 , 0.000706107427878 , 0.000809436941185 , 0.00604235779115 , 0.00428350724201 , 0.00357817744414 , 0.00370301379528 , 0.00409126184923 , 0.00476835162393 , 0.0059538319976 , 0.00734635534642 , 0.00919307058179 , 0.0124433389707 , 0.0178267900287 , 0.0238421277557 , 0.036434695937 , 0.0595335182092 , 0.156520008316 }; 

  // turn on/off batch mode
 gROOT->SetBatch(kTRUE);


 // set ROOT style
//  myStyle();
 setTDRStyle();
 gStyle->SetPadLeftMargin(0.14);
 gROOT->ForceStyle();
 
 TCanvas *c = new TCanvas("c","",800,800);
 c->cd();
 
 TH2F *bg = new TH2F("bg",title.c_str(), 500, 300., 1000., 500., 0.00001, 50.);
 bg->GetXaxis()->CenterTitle();
 bg->GetYaxis()->CenterTitle();
 bg->SetStats(kFALSE);
 bg->SetTitleOffset(1.,"X");
 bg->SetTitleOffset(1.15,"Y");
 
 bg->Draw();



 TGraph *xsTh_vs_m = new TGraph(221, mTh, xsTh);
 xsTh_vs_m->SetLineWidth(2);
 xsTh_vs_m->SetLineColor(kBlue);
 xsTh_vs_m->SetFillColor(kCyan-6);
 xsTh_vs_m->SetMarkerSize(0.00001);
 xsTh_vs_m->SetMarkerStyle(22);
 xsTh_vs_m->SetMarkerColor(kBlue);

 TGraph *xsData_vs_m_expected = new TGraph(15, mData, xsUp_expected);
 xsData_vs_m_expected->SetMarkerStyle(0);
 xsData_vs_m_expected->SetMarkerColor(kBlack);
 xsData_vs_m_expected->SetLineColor(kBlack);
 xsData_vs_m_expected->SetLineWidth(2);
 xsData_vs_m_expected->SetLineStyle(7);
 xsData_vs_m_expected->SetMarkerSize(0.001);

 TGraph *xsData_vs_m_observed = new TGraph(15, mData, xsUp_observed);
 xsData_vs_m_observed->SetMarkerStyle(21);
 xsData_vs_m_observed->SetMarkerColor(kBlack);
 xsData_vs_m_observed->SetLineColor(kBlack);
 xsData_vs_m_observed->SetLineWidth(2);
 xsData_vs_m_observed->SetLineStyle(1);
 xsData_vs_m_observed->SetMarkerSize(1);
 
 Double_t xsUp_observed_logY[15], xsUp_expected_logY[15], xsTh_logY[221];
 for (int ii = 0; ii<15; ++ii) xsUp_observed_logY[ii] = log10(xsUp_observed[ii]);
 for (int ii = 0; ii<15; ++ii) xsUp_expected_logY[ii] = log10(xsUp_expected[ii]);
 for (int ii = 0; ii<221; ++ii) xsTh_logY[ii] = log10(xsTh[ii]);
 TGraph *xsTh_vs_m_log = new TGraph(221, mTh, xsTh_logY);
 TGraph *xsData_vs_m_expected_log = new TGraph(15, mData, xsUp_expected_logY);
 TGraph *xsData_vs_m_observed_log = new TGraph(15, mData, xsUp_observed_logY);
 

 double obslim = 0.0;
 double exlim = 0.0;
 for (Double_t mtest=300.10; mtest<1199.90; mtest = mtest+0.10){
   if(( pow(10.0,xsData_vs_m_expected_log->Eval(mtest))/pow(10.0,xsTh_vs_m_log->Eval(mtest)) ) < 1.0 && ( pow(10.0,xsData_vs_m_expected_log->Eval(mtest+0.1))/pow(10.0,xsTh_vs_m_log->Eval(mtest+0.10)) ) > 1.0) exlim = mtest; 
   if(( pow(10.0,xsData_vs_m_observed_log->Eval(mtest))/pow(10.0,xsTh_vs_m_log->Eval(mtest)) ) < 1.0 && ( pow(10.0,xsData_vs_m_observed_log->Eval(mtest+0.1))/pow(10.0,xsTh_vs_m_log->Eval(mtest+0.10)) ) > 1.0) obslim = mtest; 
  }
  std::cout<<"## RPV LLJJ expected limit: "<<exlim<<" GeV"<<std::endl;
  std::cout<<"## RPV LLJJ observed limit: "<<obslim<<" GeV"<<std::endl;

 // region excluded by Tevatron limits
 // Double_t x_shaded[5] = {675,840,840,675,675};// CHANGED FOR LQ2
 // Double_t y_shaded[5] = {0.00001,0.00001,50,50,0.00001};// CHANGED FOR LQ2

 // Double_t x_shaded2[5] = {300,675,675,300,300};// CHANGED FOR LQ2
 // Double_t y_shaded2[5] = {0.00001,0.00001,50,50,0.00001};// CHANGED FOR LQ2

 // Double_t x_shaded3[5] = {840,obslim,obslim,840,840};// CHANGED FOR LQ2
 // Double_t y_shaded3[5] = {0.00001,0.00001,50,50,0.00001};// CHANGED FOR LQ2


//  TPolyLine *p2 = new TPolyLine(5,x_shaded2,y_shaded2,"");
// //  pl->SetFillStyle(3001);
//  p2->SetFillColor(8);
//  p2->SetFillStyle(3345);
//  p2->SetLineColor(8);   // CHANGED FOR LQ2
//  p2->Draw();
//  p2->Draw("F");


//  TPolyLine *pl = new TPolyLine(5,x_shaded,y_shaded,"");
// //  pl->SetFillStyle(3001);
//  pl->SetLineColor(14);
//  pl->SetFillColor(14);
//  pl->SetFillStyle(3344);
//  pl->Draw();
//  pl->Draw("F");
 
 

//  TPolyLine *p3 = new TPolyLine(5,x_shaded3,y_shaded3,"");
//  p3->SetLineColor(46);
//  p3->SetFillColor(46);
//  p3->SetFillStyle(3354);
//  p3->Draw();
//  p3->Draw("F");



 TGraph *exshade1 = new TGraph(30,x_shademasses,y_1sigma);
 exshade1->SetFillColor(kGreen);
 TGraph *exshade2 = new TGraph(30,x_shademasses,y_2sigma);
 exshade2->SetFillColor(kYellow);

 exshade2->Draw("f");
 exshade1->Draw("f");

 gPad->RedrawAxis();


 TGraph *grshade = new TGraph(442,x_pdf,y_pdf);
 grshade->SetFillColor(kCyan-6);
 grshade->SetFillStyle(3001);
 grshade->Draw("f");



 // set ROOT style
//  myStyle();
 setTDRStyle();
 gStyle->SetPadLeftMargin(0.14);
 gROOT->ForceStyle();


 
 xsTh_vs_m->Draw("L");
 xsData_vs_m_expected->Draw("LP");
 xsData_vs_m_observed->Draw("LP");


 
 grshade->SetFillStyle(1001); 


 TLegend *legend = new TLegend(.37,.62,.92,.88);
 legend->SetBorderSize(1);
 legend->SetFillColor(0);
 //legend->SetFillStyle(0);
 legend->SetTextFont(42);
 legend->SetMargin(0.15);
 legend->SetHeader("LQD232");
 // legend->AddEntry(p2,"ATLAS exclusion (1.03 fb^{-1}, 7 TeV)","f");
 // legend->AddEntry(pl,"CMS exclusion (5.0 fb^{-1}, 7TeV)","f");
 // legend->AddEntry(p3,"CMS exclusion (19.7 fb^{-1}, 8 TeV)","f");

 legend->AddEntry(xsTh_vs_m,"#sigma_{theory}#times#beta^{2}  with unc., (#beta=1)","lf");
 legend->AddEntry(xsData_vs_m_expected, "Expected 95% CL upper limit","lp");
 legend->AddEntry(xsData_vs_m_observed, "Observed 95% CL upper limit","lp");
 legend->Draw();

 TLatex l1;
 l1.SetTextAlign(12);
 l1.SetTextFont(42);
 l1.SetNDC();
 l1.SetTextSize(0.04);
// double stamp_x = 0.76;
//  double stamp_y = 0.58;

 // l1.DrawLatex(stamp_x,stamp_y - 0.00,"CMS 2012");	   
 // l1.DrawLatex(stamp_x,stamp_y - 0.05,"#sqrt{s} = 8 TeV");
  //l1.DrawLatex(0.70,0.53,"CMS 2011");
 //l1.DrawLatex(0.70,0.48,"#sqrt{s} = 7 TeV");

 l1.DrawLatex(0.14,0.93,"CMS #it{Preliminary}          #sqrt{s} = 8 TeV         19.7 fb^{-1}");
 // l1.DrawLatex(0.14,0.93,"CMS Work In Progres       #sqrt{s} = 8 TeV         19.6 fb^{-1}");
 // l1.DrawLatex(0.76,0.53,"Preliminary");
 // l1.DrawLatex(0.76,0.48,"#sqrt{s} = 8 TeV");
 // l1.DrawLatex(0.76,0.43,"19.6 fb^{-1}");
 
//  TLatex l2;
//  l2.SetTextAlign(12);
//  l2.SetTextSize(0.037);
//  l2.SetTextFont(42);
//  l2.SetNDC();
//  l2.DrawLatex(0.4,0.485,"EXO-10-005 scaled to #sqrt{s} = 7 TeV");

 c->SetGridx();
 c->SetGridy();
 c->RedrawAxis();
 legend->Draw();

 c->SetLogy();
 c->SaveAs((fileName1).c_str());
 c->SaveAs((fileName2).c_str());
 c->SaveAs((fileName3).c_str());

 // delete pl;
 delete xsTh_vs_m;
 delete bg;
 delete c;
}


void myStyle()
{
 gStyle->Reset("Default");
 gStyle->SetCanvasColor(0);
 gStyle->SetPadColor(0);
 gStyle->SetTitleFillColor(10);
 gStyle->SetCanvasBorderMode(0);
 gStyle->SetStatColor(0);
 gStyle->SetPadBorderMode(0);
 gStyle->SetPadTickX(1);  // To get tick marks on the opposite side of the frame
 gStyle->SetPadTickY(1);
 gStyle->SetFrameBorderMode(0);
 gStyle->SetPalette(1);

   //gStyle->SetOptStat(kFALSE);
 gStyle->SetOptStat(111110);
 gStyle->SetOptFit(0);
 gStyle->SetStatFont(42);
 gStyle->SetPadLeftMargin(0.13);
 gStyle->SetPadRightMargin(0.07);
 gStyle->SetStatY(.9);
}

void setTDRStyle() {
  TStyle *tdrStyle = new TStyle("tdrStyle","Style for P-TDR");

  // For the canvas:
  tdrStyle->SetCanvasBorderMode(0);
  tdrStyle->SetCanvasColor(kWhite);
  tdrStyle->SetCanvasDefH(600); //Height of canvas
  tdrStyle->SetCanvasDefW(600); //Width of canvas
  tdrStyle->SetCanvasDefX(0);   //POsition on screen
  tdrStyle->SetCanvasDefY(0);

  // For the Pad:
  tdrStyle->SetPadBorderMode(0);
  // tdrStyle->SetPadBorderSize(Width_t size = 1);
  tdrStyle->SetPadColor(kWhite);
  tdrStyle->SetPadGridX(false);
  tdrStyle->SetPadGridY(false);
  tdrStyle->SetGridColor(0);
  tdrStyle->SetGridStyle(3);
  tdrStyle->SetGridWidth(1);

  // For the frame:
  tdrStyle->SetFrameBorderMode(0);
  tdrStyle->SetFrameBorderSize(1);
  tdrStyle->SetFrameFillColor(0);
  tdrStyle->SetFrameFillStyle(0);
  tdrStyle->SetFrameLineColor(1);
  tdrStyle->SetFrameLineStyle(1);
  tdrStyle->SetFrameLineWidth(1);

  // For the histo:
  tdrStyle->SetHistFillColor(63);
  // tdrStyle->SetHistFillStyle(0);
  tdrStyle->SetHistLineColor(1);
  tdrStyle->SetHistLineStyle(0);
  tdrStyle->SetHistLineWidth(1);


  tdrStyle->SetMarkerStyle(20);

  //For the fit/function:
  tdrStyle->SetOptFit(1);
  tdrStyle->SetFitFormat("5.4g");
  tdrStyle->SetFuncColor(2);
  tdrStyle->SetFuncStyle(1);
  tdrStyle->SetFuncWidth(1);

  //For the date:
  tdrStyle->SetOptDate(0);

  // For the statistics box:
  tdrStyle->SetOptFile(0);
  tdrStyle->SetOptStat(0); // To display the mean and RMS:   SetOptStat("mr");
  tdrStyle->SetStatColor(kWhite);
  tdrStyle->SetStatFont(42);
  tdrStyle->SetStatFontSize(0.025);
  tdrStyle->SetStatTextColor(1);
  tdrStyle->SetStatFormat("6.4g");
  tdrStyle->SetStatBorderSize(1);
  tdrStyle->SetStatH(0.1);
  tdrStyle->SetStatW(0.15);


  // Margins:
  tdrStyle->SetPadTopMargin(0.1);
  tdrStyle->SetPadBottomMargin(0.13);
  tdrStyle->SetPadLeftMargin(0.13);
  tdrStyle->SetPadRightMargin(0.05);

  // For the Global title:

  //  tdrStyle->SetOptTitle(0);
  tdrStyle->SetTitleFont(42);
  tdrStyle->SetTitleColor(1);
  tdrStyle->SetTitleTextColor(1);
  tdrStyle->SetTitleFillColor(10);
  tdrStyle->SetTitleFontSize(0.05);

  // For the axis titles:

  tdrStyle->SetTitleColor(1, "XYZ");
  tdrStyle->SetTitleFont(42, "XYZ");
  tdrStyle->SetTitleSize(0.06, "XYZ");
  tdrStyle->SetTitleXOffset(0.9);
  tdrStyle->SetTitleYOffset(1.05);

  // For the axis labels:

  tdrStyle->SetLabelColor(1, "XYZ");
  tdrStyle->SetLabelFont(42, "XYZ");
  tdrStyle->SetLabelOffset(0.007, "XYZ");
  tdrStyle->SetLabelSize(0.04, "XYZ");

  // For the axis:

  tdrStyle->SetAxisColor(1, "XYZ");
  tdrStyle->SetStripDecimals(kTRUE);
  tdrStyle->SetTickLength(0.03, "XYZ");
  tdrStyle->SetNdivisions(510, "XYZ");
  tdrStyle->SetPadTickX(1);  // To get tick marks on the opposite side of the frame
  tdrStyle->SetPadTickY(1);

  // Change for log plots:
  tdrStyle->SetOptLogx(0);
  tdrStyle->SetOptLogy(0);
  tdrStyle->SetOptLogz(0);
  
  tdrStyle->cd();
}
