#include "TCanvas.h"
#include "TH1.h"
#include "TH1D.h"

void xsecs(){

  gStyle->SetOptStat(0);

  //Double_t massBins[]={100,105,110,115,120,125,130,135,140,145,150,155,160,165,170,175,180,185,190,195,200,205,210,215,220,225,230,235,240,245,250,255,260,265,270,275,280,285,290,295,300,305,310,315,320,325,330,335,340,345,350,355,360,365,370,375,380,385,390,395,400,405,410,415,420,425,430,435,440,445,450,455,460,465,470,475,480,485,490,495,500,505,510,515,520,525,530,535,540,545,550,555,560,565,570,575,580,585,590,595,600,605,610,615,620,625,630,635,640,645,650,655,660,665,670,675,680,685,690,695,700,705,710,715,720,725,730,735,740,745,750,755,760,765,770,775,780,785,790,795,800,805,810,815,820,825,830,835,840,845,850,855,860,865,870,875,880,885,890,895,900,905,910,915,920,925,930,935,940,945,950,955,960,965,970,975,980,985,990,995,1000,1005,1010,1015,1020,1025,1030,1035,1040,1045,1050,1055,1060,1065,1070,1075,1080,1085,1090,1095,1100,1105,1110,1115,1120,1125,1130,1135,1140,1145,1150,1155,1160,1165,1170,1175,1180,1185,1190,1195,1200,1205,1210,1215,1220,1225,1230,1235,1240,1245,1250,1255,1260,1265,1270,1275,1280,1285,1290,1295,1300,1305,1310,1315,1320,1325,1330,1335,1340,1345,1350,1355,1360,1365,1370,1375,1380,1385,1390,1395,1400,1405,1410,1415,1420,1425,1430,1435,1440,1445,1450,1455,1460,1465,1470,1475,1480,1485,1490,1495,1500,1505,1510,1515,1520,1525,1530,1535,1540,1545,1550,1555,1560,1565,1570,1575,1580,1585,1590,1595,1600,1605,1610,1615,1620,1625,1630,1635,1640,1645,1650,1655,1660,1665,1670,1675,1680,1685,1690,1695,1700,1705,1710,1715,1720,1725,1730,1735,1740,1745,1750,1755,1760,1765,1770,1775,1780,1785,1790,1795,1800,1805,1810,1815,1820,1825,1830,1835,1840,1845,1850,1855,1860,1865,1870,1875,1880,1885,1890,1895,1900,1905,1910,1915,1920,1925,1930,1935,1940,1945,1950,1955,1960,1965,1970,1975,1980,1985,1990,1995,2000,2005};
  Double_t massBins[]={175,225,275,325,375,425,475,525,575,625,675,725,775,825,875,925,975,1025};
  int NmassBins=(sizeof(massBins)/sizeof(Double_t))-1;

  //  Double_t xsecs[]={559.757,448.456,361.917,293.281,240.077,197.122,163.376,135.791,113.319,95.0292,80.268,68.0456,58.01,49.6639,42.6441,36.7994,31.8695,27.7028,24.1585,21.1597,18.5245,16.2439,14.3201,12.6497,11.1808,9.90959,8.78125,7.81646,6.96892,6.22701,5.57596,5.00108,4.48773,4.03416,3.63085,3.2781,2.95613,2.67442,2.42299,2.19684,1.99608,1.81486,1.64956,1.50385,1.3733,1.25277,1.14277,1.04713,0.959617,0.879793,0.807323,0.74141,0.681346,0.626913,0.576882,0.531443,0.489973,0.452072,0.4176,0.385775,0.35683,0.329881,0.305512,0.283519,0.262683,0.243755,0.226367,0.209966,0.195812,0.181783,0.169668,0.158567,0.147492,0.137392,0.128326,0.119275,0.112241,0.104155,0.0977878,0.091451,0.0855847,0.0801322,0.0751004,0.0703432,0.0660189,0.0618641,0.0580348,0.0545113,0.0511747,0.0481537,0.0452067,0.0424781,0.0399591,0.0376398,0.0354242,0.0333988,0.0313654,0.0295471,0.0279395,0.0263263,0.0248009,0.0233806,0.0220672,0.0208461,0.0196331,0.0185257,0.0175075,0.0164955,0.0155809,0.0147721,0.0139566,0.0132456,0.0125393,0.0118287,0.0112223,0.0106123,0.0100516,0.0095256,0.0090306,0.00856339,0.0081141,0.00769525,0.00730084,0.00692243,0.00656729,0.00623244,0.00591771,0.00561049,0.00532605,0.00506044,0.00480639,0.00455979,0.00433688,0.00412174,0.00391839,0.00372717,0.00354211,0.00336904,0.00320476,0.00304935,0.00289588,0.00275424,0.0026184,0.00249291,0.00237168,0.00226163,0.00214607,0.00204589,0.00195172,0.0018573,0.00176742,0.00168383,0.00160403,0.00153063,0.00145772,0.0013878,0.00132077,0.00126234,0.00120568,0.00114627,0.00109501,0.001044,0.000996193,0.00095071,0.000907494,0.000866391,0.000826533,0.000789573,0.000753768,0.000719675,0.000687022,0.000656279,0.000626876,0.000598955,0.000571551,0.000546728,0.000522495,0.000499017,0.000476255,0.000455959,0.000435488,0.000416116,0.00039791,0.000379994,0.000363934,0.000347646,0.00033204,0.000318049,0.000303756,0.000290392,0.000277943,0.000265929,0.000254659,0.000243251,0.00023289,0.000222651,0.000213396,0.000204211,0.000196038,0.000187913,0.000179699,0.000172125,0.000165045,0.000157905,0.000151236,0.000144737,0.000138657,0.000133343,0.000127478,0.00012234,0.000117215,0.000112199,0.000107256,0.000103046,9.86633e-05,9.44977e-05,9.05131e-05,8.67972e-05,8.31669e-05,7.96568e-05,7.63052e-05,7.31846e-05,7.00987e-05,6.72666e-05,6.44711e-05,6.18495e-05,5.93775e-05,5.69258e-05,5.46007e-05,5.23902e-05,5.02385e-05,4.81984e-05,4.6268e-05,4.43332e-05,4.25134e-05,4.07881e-05,3.91417e-05,3.75567e-05,3.60147e-05,3.4617e-05,3.31856e-05,3.18643e-05,3.05669e-05,2.93562e-05,2.81652e-05,2.70203e-05,2.59296e-05,2.49015e-05,2.39221e-05,2.29308e-05,2.20166e-05,2.11331e-05,2.02909e-05,1.94752e-05,1.8714e-05,1.79681e-05,1.72697e-05,1.65664e-05,1.58669e-05,1.52759e-05,1.46673e-05,1.40698e-05,1.35484e-05,1.30386e-05,1.253e-05,1.20335e-05,1.15351e-05,1.11127e-05,1.06301e-05,1.02226e-05,9.84287e-06,9.45889e-06,9.09124e-06,8.73208e-06,8.38911e-06,8.05993e-06,7.74413e-06,7.44538e-06,7.14898e-06,6.86798e-06,6.59698e-06,6.33638e-06,6.08509e-06,5.84265e-06,5.6093e-06,5.38651e-06,5.1742e-06,4.97273e-06,4.77117e-06,4.58178e-06,4.39875e-06,4.22724e-06,4.05582e-06,3.89113e-06,3.72963e-06,3.58102e-06,3.43895e-06,3.29773e-06,3.16675e-06,3.03589e-06,2.91221e-06,2.79219e-06,2.66816e-06,2.55964e-06,2.44758e-06,2.34644e-06,2.24557e-06,2.15574e-06,2.0669e-06,1.98515e-06,1.90249e-06,1.83115e-06,1.76963e-06,1.70036e-06,1.63964e-06,1.58714e-06,1.52765e-06,1.47645e-06,1.42533e-06,1.37529e-06,1.32467e-06,1.27389e-06,1.22407e-06,1.18167e-06,1.13218e-06,1.09086e-06,1.04182e-06,1.00428e-06,9.64964e-07,9.26859e-07,8.90605e-07,8.56319e-07,8.2246e-07,7.90884e-07,7.59995e-07,7.3087e-07,7.02001e-07,6.75402e-07,6.49168e-07,6.24339e-07,6.00052e-07,5.76531e-07,5.5474e-07,5.33316e-07,5.129e-07,4.93338e-07,4.74104e-07,4.55409e-07,4.37889e-07,4.21436e-07,4.04973e-07,3.89723e-07,3.7399e-07,3.59977e-07,3.45452e-07,3.32155e-07,3.19667e-07,3.06274e-07,2.95073e-07,2.83743e-07,2.724e-07,2.62039e-07,2.51734e-07,2.4149e-07,2.32237e-07,2.23897e-07,2.14605e-07,2.06292e-07,1.99019e-07,1.90756e-07,1.83446e-07,1.7615e-07,1.69813e-07,1.62682e-07,1.56389e-07,1.51029e-07,1.44807e-07,1.39563e-07,1.34259e-07,1.29026e-07,1.23774e-07};

  //  Double_t sigmas[]={16.1085,15.9732,16.1134,15.9763,15.9212,15.7303,15.8101,15.8086,15.7234,15.649,15.5946,15.5232,15.3899,15.3711,15.3017,15.1749,15.2449,15.063,15.16,14.9422,14.9147,15.117,14.8495,14.8689,14.9108,14.9662,14.796,14.7983,14.7878,14.7897,14.7529,14.729,14.6782,14.7964,14.6565,14.7341,14.7816,14.7661,14.6805,14.8465,14.6905,14.4434,14.4769,14.4549,14.7503,14.2875,14.578,14.3659,14.3896,14.3881,14.3597,14.368,14.3357,14.3627,14.2712,14.266,14.3962,14.2234,14.3166,14.3112,14.2848,14.2072,14.2648,14.102,14.3075,14.0504,14.0494,14.0334,14.0772,14.1771,14.2368,14.2609,14.4105,14.4772,14.5144,14.6664,14.6307,14.7581,14.7977,14.8963,14.9611,15.0389,15.1402,15.2139,15.3368,15.4135,15.4422,15.5446,15.6283,15.726,15.8177,15.9022,16.0067,16.0367,16.137,16.2132,16.3135,16.4264,16.4546,16.567,16.6406,16.7295,16.8447,16.9276,17.0459,17.0835,17.1478,17.2753,17.3814,17.4885,17.56,17.6129,17.7363,17.7959,17.8974,17.9891,18.0618,18.1714,18.2108,18.3365,18.4146,18.4937,18.6195,18.7005,18.819,18.8796,18.996,19.0787,19.1995,19.2916,19.4088,19.508,19.632,19.7141,19.8299,19.9097,20.0016,20.123,20.2271,20.4479,20.516,20.5444,20.8204,21.0063,21.0865,21.0511,21.3705,21.3026,21.6053,21.8177,21.836,22.1411,22.0506,22.3461,22.6206,22.5422,23.2161,23.1283,23.8404,23.7327,23.9439,24.1049,24.2789,24.5443,24.7597,24.877,25.0849,25.2885,25.4768,25.6582,25.8341,26.0372,26.2059,26.3653,26.5169,26.7985,26.9218,27.1036,27.3032,27.4544,27.6595,27.8649,27.9983,28.2833,28.4046,28.5755,28.8856,28.9792,29.0799,29.3415,29.6252,29.7061,29.946,30.237,30.4322,30.6837,30.9264,31.1401,31.3673,31.5579,31.8291,32.3718,32.5508,32.8048,32.6359,33.2161,33.4105,33.9387,33.9505,34.2228,34.5171,34.6636,34.7177,35.14,35.2448,35.491,35.6874,35.8364,36.0309,36.1691,36.4029,36.5593,36.8407,37.0524,37.2551,37.4468,37.73,37.9974,38.1849,38.4532,38.7169,38.9583,39.295,39.533,39.7556,40.0677,40.3688,40.5687,40.8636,41.111,41.3826,41.6171,41.8635,42.0558,42.2681,42.6434,42.8496,43.1496,43.2927,43.3701,43.7141,43.7576,44.275,44.5547,44.489,45.0069,45.2231,45.3811,45.629,45.6655,45.9932,46.2074,46.5574,46.9138,47.235,47.4376,47.6339,48.0539,48.0551,48.3748,48.7594,49.0619,49.2373,49.5338,49.7994,50.0207,50.3417,50.5264,50.7934,51.0213,51.2711,51.4848,51.7365,51.9947,52.2054,52.4747,52.7563,52.9922,53.2497,53.4133,53.7199,53.9776,54.2081,54.5909,54.8285,54.9611,55.2433,55.5563,55.7857,55.9798,56.3512,56.5093,56.8717,56.9442,57.2952,57.5294,57.7382,57.8618,58.016,58.2828,58.651,58.9189,59.2455,59.4164,59.6636,60.0861,60.2995,60.5926,60.8999,61.1528,61.392,61.6317,61.8075,62.2826,62.4136,62.7163,62.7379,63.1036,63.3464,63.6113,63.8391,64.0747,64.3035,64.5973,64.8419,65.0354,65.3007,65.5868,65.7934,66.0476,66.2636,66.5428,66.8028,67.0617,67.2985,67.6074,67.7943,68.0365,68.3383,68.6014,68.8823,69.08,69.4608,69.5443,69.8554,70.0667,70.3694,70.6069,70.7798,70.9919,71.2184,71.4803,71.6697,71.8236,72.076,72.3551,72.5351,72.7478,73.0776,73.2183,73.4612,73.6804,73.9751,74.0833,74.3243,74.6914,74.8288,75.1522,75.4315,75.6265,75.8327};

  Double_t xsecs[]={18.5245,5.57596,1.99608,0.807323,0.35683,0.169668,0.0855847,0.0452067,0.0248009,0.0139566,0.0081141,0.00480639,0.00289588,0.00176742,0.00109501,0.000687022,0.000435488};

  Double_t sigmas[]={14.9147,14.7529,14.6905, 14.3597, 14.284, 14.2368,14.9611,15.8177,16.6406, 17.56,18.4146,19.4088,20.516,21.836, 23.9439,25.8341, 27.6595};

  TCanvas *c1 = new TCanvas("c1","",1000,600);
  c1->cd();c1->Draw();c1->SetLogy(1);

  TH1D* h_xsecs = new TH1D("h_xsecs",";m_{ #tilde{t}}  [GeV];#sigma  [pb]",NmassBins,massBins);

  for(int i=0;i<NmassBins;i++){
    h_xsecs->SetBinContent(i+1,xsecs[i]);
    h_xsecs->SetBinError(i+1,.01*sigmas[i]*xsecs[i]);
  }

  TPaveText *t = new TPaveText(.5,.54,.8,.74,"NDC");
  t->AddText("stop pair production");
  t->AddText("m_{ #tilde{h}} = m_{ #tilde{t}}  - 100 GeV");
  t->SetFillStyle(0);
  t->SetTextFont(42);
  t->SetFillColor(0);
  t->SetBorderSize(0);

  h_xsecs->SetMarkerSize(0.9);//h_xsecs->SetLineWidth(0.5);
  h_xsecs->SetMarkerColor(kBlue);h_xsecs->SetLineColor(kBlue);
  h_xsecs->Draw("PE");
  t->Draw();
  c1->Print("h_xsecs.png");
 
  return;
}
